from datetime import datetime
from datetime import timedelta
import pandas as pd

festival_dict = {'2022-01-01': '2022新曆新年',
                 '2022-02-01': '農曆年初一',
                 '2022-02-02': '農曆年初二',
                 '2022-02-03': '農曆年初三',
                 '2022-02-14': '情人節',
                 '2022-02-15': '元宵節',
                 '2022-03-14': '白色情人節',
                 '2022-04-18': '復活節',
                 '2022-05-08': '母親節',
                 '2022-06-03': '端午節',
                 '2022-06-19': '父親節',
                 '2022-08-04': '七夕節',
                 '2022-09-10': '中秋節',
                 '2022-10-31': '萬聖節',
                 '2022-11-24': '感恩節',
                 '2022-12-25': '聖誕節',
                 '2023-01-01': '2023新曆新年',
                 '2023-01-22': '農曆年初一',
                 '2023-01-23': '農曆年初二',
                 '2023-01-24': '農曆年初三',
                 '2023-02-05': '元宵節',
                 '2023-02-14': '情人節',
                 '2023-03-14': '白色情人節',
                 '2023-04-10': '復活節',
                 '2023-05-14': '母親節',
                 '2023-06-19': '父親節',
                 '2023-06-22': '端午節',
                 '2023-08-22': '七夕節',
                 '2023-09-29': '中秋節',
                 '2023-10-31': '萬聖節',
                 '2023-11-23': '感恩節',
                 '2023-12-25': '聖誕節'}
public_holiday_list = ['2022-01-01',
                       '2022-01-01',
                       '2022-02-02',
                       '2022-03-03',
                       '2022-05-05',
                       '2022-15-15',
                       '2022-16-16',
                       '2022-18-18',
                       '2022-02-02',
                       '2022-09-09',
                       '2022-03-03',
                       '2022-01-01',
                       '2022-12-12',
                       '2022-01-01',
                       '2022-04-04',
                       '2022-26-26',
                       '2022-27-27']
good_days_list = ['2022-01-05',
                  '2022-01-16',
                  '2022-01-19',
                  '2022-01-22',
                  '2022-01-28',
                  '2022-01-31',
                  '2022-02-04',
                  '2022-02-11',
                  '2022-02-19',
                  '2022-02-23',
                  '2022-03-04',
                  '2022-03-07',
                  '2022-03-19',
                  '2022-03-24',
                  '2022-03-30',
                  '2022-04-03',
                  '2022-04-09',
                  '2022-04-19',
                  '2022-04-23',
                  '2022-05-05',
                  '2022-05-08',
                  '2022-05-11',
                  '2022-05-15',
                  '2022-05-20',
                  '2022-05-26',
                  '2022-06-01',
                  '2022-06-04',
                  '2022-06-12',
                  '2022-06-14',
                  '2022-06-20',
                  '2022-06-23',
                  '2022-07-05',
                  '2022-07-07',
                  '2022-07-12',
                  '2022-07-15',
                  '2022-07-18',
                  '2022-07-20',
                  '2022-07-25',
                  '2022-07-31',
                  '2022-08-06',
                  '2022-08-09',
                  '2022-08-11',
                  '2022-08-18',
                  '2022-08-21',
                  '2022-08-31',
                  '2022-09-09',
                  '2022-09-14',
                  '2022-09-21',
                  '2022-09-26',
                  '2022-09-30',
                  '2022-10-06',
                  '2022-10-10',
                  '2022-10-17',
                  '2022-10-24',
                  '2022-11-01',
                  '2022-11-03',
                  '2022-11-07',
                  '2022-11-19',
                  '2022-11-25',
                  '2022-12-03',
                  '2022-12-14',
                  '2022-12-26', ]
wedding_expo_list = ['2022-02-11',
                     '2022-02-12',
                     '2022-02-13',
                     '2022-06-03',
                     '2022-06-04',
                     '2022-06-05',
                     '2022-08-26',
                     '2022-08-27',
                     '2022-08-28',
                     '2022-12-09',
                     '2022-12-10',
                     '2022-12-11', ]


dim_date_list = []
new_year = datetime(2022, 1, 1, 0, 0, 0, 0)
for num in range(35):
    date = (new_year + timedelta(days=num))
    if date.strftime("%Y-%m-%d") in festival_dict:
        festival = festival_dict[date.strftime("%Y-%m-%d")]
    date_row = {
        "year": int(date.strftime('%Y')),
        "month": int(date.strftime('%m')),
        "day": int(date.strftime('%d')),
        "quarter": int(date.month/3)+1,
        "day_of_week_num": date.weekday(),
        "day_of_week_eng_abbr": date.strftime('%a'),
        "festival": festival_dict[date.strftime(
            "%Y-%m-%d")] if date.strftime("%Y-%m-%d") in festival_dict else False,
        "is_good_days": True if date in good_days_list else False,
        "is_weekend": True if date.weekday() == 6 | 0 else False,
        "is_public_holiday": True if date in public_holiday_list | date.weekday() == 6 else False,
        "is_wedding_expo": True if date in wedding_expo_list else False
    }
    dim_date_list.append(date_row)
pd.set_option('display.max_colwidth', None)
df = pd.DataFrame(dim_date_list)
